<div class="d-flex justify-content-center gap-2" style="margin-top:3%;">
  <button id="editBtn" type="button" class="btn btn-primary">Edit Flashcards</button>
  <button id="studyBtn" type="button" class="btn btn-primary">Study Flashcards</button>
</div>

<div class="d-flex justify-content-center gap-2" style="margin-top:10px;">
  <button id="createBtn" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#flashcard-modal">
    Add Flashcard
  </button>
</div>

<!-- Flashcard modal -->
<div class="modal" tabindex="-1" id="flashcard-modal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Create Flashcard</h5>
      </div>

      <div class="modal-body">
        <form id="flashcard-form">
          <div class="mb-3">
            <label for="flashcard_name">Flashcard name</label>
            <input type="text" class="form-control" id="flashcard_name" name="flashcard_name" required>
          </div>

          <div class="mb-3">
            <label for="flashcard_description">Flashcard description</label>
            <textarea class="form-control" id="flashcard_description" name="flashcard_description" maxlength="300" rows="3" placeholder="Enter description (max 300 characters)" required></textarea>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary" form="flashcard-form">Save changes</button>
      </div>
    </div>
  </div>
</div>

<!-- Container that holds all flashcards -->
<div id="flashcardList" style="margin-left:20%; margin-right:20%; margin-top:20px;">

</div>

<!-- Flashcard carousel -->
<div id="flashcardCarousel" class="carousel slide" data-bs-interval="false" style="display:none;">
  <div class="carousel-inner">

    <div class="carousel-item active">
      <div class="flashcard click-flip mx-auto">
        <div class="flashcard-inner">
          <div class="flashcard-front">What is the capital of France?</div>
          <div class="flashcard-back">Paris</div>
        </div>
      </div>
    </div>

    <div class="carousel-item">
      <div class="flashcard click-flip mx-auto">
        <div class="flashcard-inner">
          <div class="flashcard-front">What is 2 + 2?</div>
          <div class="flashcard-back">4</div>
        </div>
      </div>
    </div>

  </div>

  <div class="text-center mt-3 d-flex justify-content-center gap-3">
    <button class="carousel-bottom-btn" data-bs-target="#flashcardCarousel" data-bs-slide="next">
      <span class="carousel-control-prev-icon"></span>
    </button>

    <button class="carousel-bottom-btn" data-bs-target="#flashcardCarousel" data-bs-slide="prev">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {

    // Flashcard flipping
    document.querySelectorAll(".click-flip").forEach(card => {
      card.addEventListener("click", () => {
        card.classList.toggle("flipped");
      });
    });

    const studyBtn = document.getElementById("studyBtn");
    const editBtn = document.getElementById("editBtn");
    const carousel = document.getElementById("flashcardCarousel");
    const flashBtn = document.getElementById("createBtn");
    const flashcardList = document.getElementById("flashcardList");

    // Study mode
    studyBtn.addEventListener("click", () => {
      flashcardList.style.display = "none";
      carousel.style.display = "block";
      flashBtn.style.display = "none";
    });

    // Edit mode
    editBtn.addEventListener("click", () => {
      carousel.style.display = "none";
      flashcardList.style.display = "block";
      flashBtn.style.display = "block";
    });

    // insert new flashcards
    const form = document.getElementById("flashcard-form");
    const flashcardModal = document.getElementById("flashcard-modal");

    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const name = document.getElementById("flashcard_name").value.trim();
      const desc = document.getElementById("flashcard_description").value.trim();

      if (!name || !desc) return;

      if (desc.length > 300) {
        alert("Description cannot exceed 300 characters.");
        return;
      }

      const newCard = `
        <div class="card mb-3 flashcard-item">
          <div class="row align-items-center">
            <div class="col-md-4 col-12">
              <h5 class="card-title mb-0">${name}</h5>
            </div>
            <div class="col-md-8 col-12">
              <p class="card-text mb-0">${desc}</p>
            </div>
          </div>
        </div>
      `;

      flashcardList.insertAdjacentHTML("beforeend", newCard);
      form.reset();

      const modal = bootstrap.Modal.getInstance(flashcardModal);
      modal.hide();
    });

  });
</script>
